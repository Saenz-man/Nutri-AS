generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}
model User {
  id           String        @id @default(uuid())
  nombre       String
  apellido     String
  email        String        @unique
  password     String
  telefono     String
  carrera      String
  cumplea√±os  DateTime
  fotoPerfil   String?
  fotoBanner   String?
  status       UserStatus    @default(PENDING_PAYMENT)
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  maxPatients  Int           @default(10)
  appointments Appointment[]
  patients     Patient[]
}

model Patient {
  id              String         @id @default(uuid())
  expediente      String         @unique
  nombre          String
  apellido        String
  email           String?
  telefono        String?
  fechaNacimiento DateTime?
  foto            String?
  nutritionistId  String
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  status          PatientStatus  @default(ACTIVO)
  appointments    Appointment[]
  consultations   Consultation[]
  nutritionist    User           @relation(fields: [nutritionistId], references: [id])
}

model Consultation {
  id         String   @id @default(uuid())
  fecha      DateTime @default(now())
  peso       Float
  talla      Float
  imc        Float
  subjetivo  String?
  objetivo   String?
  planAccion String?
  patientId  String
  createdAt  DateTime @default(now())
  patient    Patient  @relation(fields: [patientId], references: [id])
}

model Appointment {
  id             String   @id @default(uuid())
  fechaHora      DateTime
  motivo         String?  @default("Consulta de Seguimiento")
  status         String   @default("PENDIENTE")
  patientId      String
  nutritionistId String
  createdAt      DateTime @default(now())
  nutritionist   User     @relation(fields: [nutritionistId], references: [id])
  patient        Patient  @relation(fields: [patientId], references: [id])
}

enum UserStatus {
  PENDING_PAYMENT
  ACTIVE
  TEST_USER
}
